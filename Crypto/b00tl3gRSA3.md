# b00tl3gRSA3
- Người giải: Temma
- Thể loại: Mật mã
- Link đề: https://play.picoctf.org/practice/challenge/78?category=2&difficulty=3&page=2

## Đề bài
Why use p and q when I can use more? 

## Giải pháp
- Hầu hết khi mới tiếp cận bài CTF liên quan dến mã RSA, đa số đều nghĩ đến các dạng bài cơ bản:
        - n có thể phân tích thành p và q
        - e nhỏ 
- Nhưng đề bài có gợi ý rằng sẽ có nhiều hơn 2 nhân tử p và q, thì phương án giải quyết như thế nào:
- Đầu tiên lấy các giá trị n,e,c qua kênh nc jupiter.challenges.picoctf.org 3726
```
n = 29863009262043856716544771610579218197492876896498688701825019839722737931293718515029849159079000860211298248574267223643101438923980557664972356897680381009700257352634510643248783741534890032565187593643833722008966931868067903315918841357551929853173187154271717532421583469683750004422780658928591702984791292785641314722540512804254049701

e = 65537

c = 28283203200106718339459221440934473087667610396852542328051407062119012903037940074225685244789395041946217450716445213710321086273589908182505356637309233847453777896871738863550058252706703314270972516048516096615392923022602254060451706906691768041530486260400782935032005710522852756962069692743931944143849135576494700284895835828228191663

```
- Có thể thử phân tích n ra thừa số nguyên tố qua trang https://www.alpertron.com.ar/ECM.HTM ( không dùng factorydb.com được vì quá nhiều nhân tử)
- Trang cũng sẽ đưa ra cả giá trị phi, thay vào, tính nghịch đảo của e qua phi (có thể dùng thư viện pycryptodome hoặc tự tạo hàm nghịch đảo module )
- Có thể tham khảo script sau:
```
#!/usr/bin/python3

from Crypto.Util.number import *

n = 29863009262043856716544771610579218197492876896498688701825019839722737931293718515029849159079000860211298248574267223643101438923980557664972356897680381009700257352634510643248783741534890032565187593643833722008966931868067903315918841357551929853173187154271717532421583469683750004422780658928591702984791292785641314722540512804254049701

e = 65537

c = 28283203200106718339459221440934473087667610396852542328051407062119012903037940074225685244789395041946217450716445213710321086273589908182505356637309233847453777896871738863550058252706703314270972516048516096615392923022602254060451706906691768041530486260400782935032005710522852756962069692743931944143849135576494700284895835828228191663

phi_tg = """
29 863009 179565 780444 873372 013744 515018 491792 404719 394916 413509 603939
757115 179079 049111 090777 541039 918330 211980 846327 407563 253961 798399
152064 239665 405535 831074 624284 231452 101855 660543 066646 102986 594822
310883 602599 743568 359526 192091 714183 579375 340982 740668 275638 532692
604135 729393 724049 427421 731745 353496 036401 867949 144398 762488 648171
520000 000000
"""

phi_str = "".join(phi_tg.split())

phi = int(phi_str)
d = inverse(e,phi)

print(long_to_bytes(pow(c,d,n)).decode())
```
- Như vậy là đã có flag rồi: picoCTF{too_many_fact0rs_8606199}